{"ast":null,"code":"import _regeneratorRuntime from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Editor.js\";\nimport React, { useState, useEffect } from 'react';\nimport useTitle from '../hooks/useTitle';\nimport useApi from '../hooks/useApi';\nimport SvgCanvas from '../components/SvgCanvas';\nimport Loading from '../components/Loading';\nimport AlertContext from '../contexts/Alert';\nimport { ALERT_VARIANTS } from '../config/constants';\nexport default (function (_ref) {\n  var params = _ref.match.params;\n  useTitle('Dodaj grafikę');\n  var api = useApi();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var _AlertContext = AlertContext(),\n      createAlert = _AlertContext.createAlert;\n\n  var fetchItem =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading(true);\n              _context.prev = 1;\n              _context.next = 4;\n              return api.get(\"/api/editor/\".concat(params.id, \"/\"));\n\n            case 4:\n              response = _context.sent;\n              _context.next = 11;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](1);\n              createAlert(\"B\\u0142\\u0105d pobierania danych z serwisu \".concat(String.fromCodePoint(0x26a0)), ALERT_VARIANTS.danger);\n              return _context.abrupt(\"return\");\n\n            case 11:\n              setData(JSON.parse(response.data.config));\n              setIsLoading(false);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 7]]);\n    }));\n\n    return function fetchItem() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (params.id) {\n      fetchItem();\n    }\n\n    setIsLoading(false);\n  }, []);\n\n  var save =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(_ref3) {\n      var config, source;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              config = _ref3.config, source = _ref3.source;\n              setIsLoading(true);\n              setData(config);\n              _context2.prev = 3;\n              _context2.next = 6;\n              return api({\n                url: \"api/editor/\".concat(params.id ? \"\".concat(params.id, \"/\") : ''),\n                method: params.id ? 'put' : 'post',\n                data: {\n                  config: JSON.stringify(config),\n                  source: source\n                }\n              });\n\n            case 6:\n              _context2.next = 12;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](3);\n              createAlert(\"B\\u0142\\u0105d pobierania danych z serwisu \".concat(String.fromCodePoint(0x26a0)), ALERT_VARIANTS.danger);\n              return _context2.abrupt(\"return\");\n\n            case 12:\n              setIsLoading(false);\n              createAlert(\"Sukces, obraz zosta\\u0142 pomy\\u015Blnie zapisany \".concat(String.fromCodePoint(0x26a0)), ALERT_VARIANTS.success);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[3, 8]]);\n    }));\n\n    return function save(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Loading, {\n    isActive: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, React.createElement(SvgCanvas, {\n    initialValue: data,\n    save: save,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }));\n});","map":{"version":3,"sources":["/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Editor.js"],"names":["React","useState","useEffect","useTitle","useApi","SvgCanvas","Loading","AlertContext","ALERT_VARIANTS","params","match","api","data","setData","isLoading","setIsLoading","createAlert","fetchItem","get","id","response","String","fromCodePoint","danger","JSON","parse","config","save","source","url","method","stringify","success"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport useTitle from '../hooks/useTitle';\nimport useApi from '../hooks/useApi';\nimport SvgCanvas from '../components/SvgCanvas';\nimport Loading from '../components/Loading';\nimport AlertContext from '../contexts/Alert';\nimport { ALERT_VARIANTS } from '../config/constants';\n\nexport default ({ match: { params } }) => {\n  useTitle('Dodaj grafikę');\n\n  const api = useApi();\n  const [data, setData] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const { createAlert } = AlertContext();\n\n  const fetchItem = async () => {\n    setIsLoading(true);\n\n    let response;\n\n    try {\n      response = await api.get(`/api/editor/${params.id}/`);\n    } catch (error) {\n      createAlert(\n        `Błąd pobierania danych z serwisu ${String.fromCodePoint(0x26a0)}`,\n        ALERT_VARIANTS.danger\n      );\n      return;\n    }\n\n    setData(JSON.parse(response.data.config));\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    if (params.id) {\n      fetchItem();\n    }\n    setIsLoading(false);\n  }, []);\n\n  const save = async ({ config, source }) => {\n    setIsLoading(true);\n    setData(config);\n\n    try {\n      await api({\n        url: `api/editor/${params.id ? `${params.id}/` : ''}`,\n        method: params.id ? 'put' : 'post',\n        data: {\n          config: JSON.stringify(config),\n          source\n        }\n      });\n    } catch (error) {\n      createAlert(\n        `Błąd pobierania danych z serwisu ${String.fromCodePoint(0x26a0)}`,\n        ALERT_VARIANTS.danger\n      );\n      return;\n    }\n\n    setIsLoading(false);\n    createAlert(\n      `Sukces, obraz został pomyślnie zapisany ${String.fromCodePoint(0x26a0)}`,\n      ALERT_VARIANTS.success\n    );\n  };\n\n  return (\n    <Loading isActive={isLoading}>\n      <SvgCanvas initialValue={data} save={save} />\n    </Loading>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}
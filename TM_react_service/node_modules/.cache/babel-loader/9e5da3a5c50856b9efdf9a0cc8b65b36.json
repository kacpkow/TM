{"ast":null,"code":"import _regeneratorRuntime from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/home/kacper/Pulpit/prg/TK/tk-pro/src/views/SignUp.js\";\nimport React, { useState } from 'react';\nimport _ from 'lodash';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport Field from '../components/Field';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\nexport default (function (_ref) {\n  var history = _ref.history;\n  useTitle('Rejestracja');\n\n  var _AlertContext = AlertContext(),\n      createAlert = _AlertContext.createAlert;\n\n  var _useForm = useForm(),\n      field = _useForm.field,\n      fields = _useForm.fields;\n\n  var _useState = useState({}),\n      errors = _useState.errors,\n      setErrors = _useState.setErrors;\n\n  var api = useApi();\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              _context.prev = 1;\n              _context.next = 4;\n              return api.post('/api/register/', fields);\n\n            case 4:\n              response = _context.sent;\n              _context.next = 11;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](1);\n              createAlert(\"B\\u0142\\u0105d rejestracji, spr\\xF3buj ponownie! \".concat(String.fromCodePoint(0x26a0)), ALERT_VARIANTS.warning);\n              return _context.abrupt(\"return\");\n\n            case 11:\n              if (response.status === 201) {\n                createAlert('Rejestracja zakończona pomyślnie! Twoje konto oczekuje na aktywację', ALERT_VARIANTS.success);\n                history.push({\n                  pathname: '/zaloguj',\n                  state: {\n                    auth: true\n                  }\n                });\n              } else {\n                createAlert(\"B\\u0142\\u0105d rejestracji! \".concat(String.fromCodePoint(0x1f44b)), ALERT_VARIANTS.warning);\n                setErrors({\n                  username: 'Nazwa jest zajeta'\n                });\n              }\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 7]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(Field, Object.assign({\n    label: \"Nazwa u\\u017Cytkownika\",\n    error: _.get(errors, 'username')\n  }, field('username'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Adres email\"\n  }, field('email'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Has\\u0142o\",\n    type: \"password\"\n  }, field('password'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Powt\\xF3rz has\\u0142o\",\n    type: \"password\"\n  }, field('repassword'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  })), React.createElement(Button, {\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, \"Zarejestruj si\\u0119\"));\n});","map":{"version":3,"sources":["/home/kacper/Pulpit/prg/TK/tk-pro/src/views/SignUp.js"],"names":["React","useState","_","AlertContext","useTitle","useForm","Field","Button","ALERT_VARIANTS","useApi","history","createAlert","field","fields","errors","setErrors","api","handleSubmit","e","preventDefault","post","response","String","fromCodePoint","warning","status","success","push","pathname","state","auth","username","get"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport _ from 'lodash';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport Field from '../components/Field';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\n\nexport default ({ history }) => {\n  useTitle('Rejestracja');\n\n  const { createAlert } = AlertContext();\n  const { field, fields } = useForm();\n  const { errors, setErrors } = useState({});\n  const api = useApi();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    let response;\n\n    try {\n      response = await api.post('/api/register/', fields);\n    } catch (error) {\n      createAlert(\n        `Błąd rejestracji, spróbuj ponownie! ${String.fromCodePoint(0x26a0)}`,\n        ALERT_VARIANTS.warning\n      );\n      return;\n    }\n\n    if (response.status === 201) {\n      createAlert(\n        'Rejestracja zakończona pomyślnie! Twoje konto oczekuje na aktywację',\n        ALERT_VARIANTS.success\n      );\n      history.push({\n        pathname: '/zaloguj',\n        state: {\n          auth: true\n        }\n      });\n    } else {\n      createAlert(\n        `Błąd rejestracji! ${String.fromCodePoint(0x1f44b)}`,\n        ALERT_VARIANTS.warning\n      );\n\n      setErrors({\n        username: 'Nazwa jest zajeta'\n      });\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <Field label=\"Nazwa użytkownika\" error={_.get(errors, 'username')} {...field('username')} />\n      <Field label=\"Adres email\" {...field('email')} />\n      <Field label=\"Hasło\" type=\"password\" {...field('password')} />\n      <Field label=\"Powtórz hasło\" type=\"password\" {...field('repassword')} />\n\n      <Button type=\"submit\">Zarejestruj się</Button>\n    </form>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}
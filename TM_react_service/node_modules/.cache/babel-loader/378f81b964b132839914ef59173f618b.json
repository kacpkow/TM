{"ast":null,"code":"import _regeneratorRuntime from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Account.js\";\nimport React, { useState, useEffect } from 'react';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport UserContext from '../contexts/User';\nimport Field from '../components/Field';\nimport Loading from '../components/Loading';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\nexport default (function () {\n  useTitle('Moje konto');\n  var api = useApi();\n\n  var _AlertContext = AlertContext(),\n      createAlert = _AlertContext.createAlert;\n\n  var _useForm = useForm(),\n      field = _useForm.field,\n      fields = _useForm.fields,\n      setFields = _useForm.setFields;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              setIsLoading(true);\n              _context.prev = 2;\n              _context.next = 5;\n              return api.put('/api/change_user_values/', fields);\n\n            case 5:\n              response = _context.sent;\n              _context.next = 12;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](2);\n              createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.warning);\n              return _context.abrupt(\"return\");\n\n            case 12:\n              if (response.status === 202) {\n                createAlert('Zmiana danych zakończona pomyślnie', ALERT_VARIANTS.success);\n                getUserFromApi();\n              } else {\n                createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.warning);\n              }\n\n              setIsLoading(false);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 8]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getUserFromApi =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var response, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return api.get('/api/user/');\n\n            case 3:\n              response = _context2.sent;\n              _context2.next = 10;\n              break;\n\n            case 6:\n              _context2.prev = 6;\n              _context2.t0 = _context2[\"catch\"](0);\n              createAlert('Błąd pobierania danych użytkownika z serwisu', ALERT_VARIANTS.warning);\n              return _context2.abrupt(\"return\");\n\n            case 10:\n              if (response.status === 200) {\n                res = response.data;\n                setIsLoading(false);\n                setFields({\n                  username: res.user[0].username,\n                  email: res.user[0].email\n                });\n              }\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 6]]);\n    }));\n\n    return function getUserFromApi() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getUserFromApi();\n  }, []);\n  return React.createElement(Loading, {\n    isActive: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(Field, Object.assign({\n    label: \"Nazwa u\\u017Cytkownika\"\n  }, field('username'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Adres email\"\n  }, field('email'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Has\\u0142o\",\n    type: \"password\"\n  }, field('password'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Powt\\xF3rz has\\u0142o\",\n    type: \"password\"\n  }, field('repassword'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  })), React.createElement(Button, {\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, \"Zapisz zmiany\")));\n});","map":{"version":3,"sources":["/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Account.js"],"names":["React","useState","useEffect","AlertContext","useTitle","useForm","UserContext","Field","Loading","Button","ALERT_VARIANTS","useApi","api","createAlert","field","fields","setFields","isLoading","setIsLoading","handleSubmit","e","preventDefault","put","response","warning","status","success","getUserFromApi","get","res","data","username","user","email"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport UserContext from '../contexts/User';\nimport Field from '../components/Field';\nimport Loading from '../components/Loading';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\n\nexport default () => {\n  useTitle('Moje konto');\n\n  const api = useApi();\n\n  const { createAlert } = AlertContext();\n  const { field, fields, setFields } = useForm();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    let response;\n    setIsLoading(true);\n\n    try {\n      response = await api.put('/api/change_user_values/', fields);\n    } catch (error) {\n      createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.warning);\n      return;\n    }\n\n    if (response.status === 202) {\n      createAlert('Zmiana danych zakończona pomyślnie', ALERT_VARIANTS.success);\n      getUserFromApi();\n    } else {\n      createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.warning);\n    }\n    setIsLoading(false);\n  };\n\n  const getUserFromApi = async () => {\n    let response;\n\n    try {\n      response = await api.get('/api/user/');\n    } catch (error) {\n      createAlert('Błąd pobierania danych użytkownika z serwisu', ALERT_VARIANTS.warning);\n      return;\n    }\n\n    if (response.status === 200) {\n      const res = response.data;\n      setIsLoading(false);\n\n      setFields({\n        username: res.user[0].username,\n        email: res.user[0].email\n      });\n    }\n  };\n\n  useEffect(() => {\n    getUserFromApi();\n  }, []);\n\n  return (\n    <Loading isActive={isLoading}>\n      <form onSubmit={handleSubmit}>\n        <Field label=\"Nazwa użytkownika\" {...field('username')} />\n        <Field label=\"Adres email\" {...field('email')} />\n        <Field label=\"Hasło\" type=\"password\" {...field('password')} />\n        <Field label=\"Powtórz hasło\" type=\"password\" {...field('repassword')} />\n\n        <Button type=\"submit\">Zapisz zmiany</Button>\n      </form>\n    </Loading>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}
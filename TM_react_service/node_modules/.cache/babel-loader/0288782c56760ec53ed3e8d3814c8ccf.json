{"ast":null,"code":"import _regeneratorRuntime from \"/home/kacper/Pulpit/tk-new-3/tk-pro-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kacper/Pulpit/tk-new-3/tk-pro-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/kacper/Pulpit/tk-new-3/tk-pro-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kacper/Pulpit/tk-new-3/tk-pro-master/src/views/partials/UploadGridModal.js\";\nimport React, { useState, useEffect } from 'react';\nimport useApi from '../../hooks/useApi';\nimport AlertContext from '../../contexts/Alert';\nimport Modal from '../../components/Modal';\nimport Loading from '../../components/Loading';\nimport Separator from '../../components/Separator';\nimport Button from '../../components/Button';\nimport UploadModal from './UploadModal';\nimport { ALERT_VARIANTS, API_URL } from '../../config/constants';\nexport default (function (_ref) {\n  var isOpen = _ref.isOpen,\n      onClose = _ref.onClose,\n      onSelect = _ref.onSelect;\n\n  var _AlertContext = AlertContext(),\n      createAlert = _AlertContext.createAlert;\n\n  var api = useApi();\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isModal = _useState4[0],\n      setIsModal = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      items = _useState6[0],\n      setItems = _useState6[1];\n\n  var openModal = function openModal() {\n    return setIsModal(true);\n  };\n\n  var closeModal = function closeModal() {\n    return setIsModal(false);\n  };\n\n  var fetchList =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _ref3, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading(true);\n              _context.prev = 1;\n              _context.next = 4;\n              return api.get('/api/images/');\n\n            case 4:\n              _ref3 = _context.sent;\n              data = _ref3.data;\n              setItems(data.images.map(function (item) {\n                return {\n                  id: item.id,\n                  url: API_URL + item.pic,\n                  name: item.pic_text\n                };\n              }));\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              createAlert(\"B\\u0142\\u0105d podczas \\u0142adowania plik\\xF3w \".concat(String.fromCodePoint(0x26a0)), ALERT_VARIANTS.danger);\n\n            case 12:\n              setIsLoading(false);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 9]]);\n    }));\n\n    return function fetchList() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchList();\n  }, []);\n  return React.createElement(Loading, {\n    isActive: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, React.createElement(Modal, {\n    isOpen: isOpen,\n    onClose: onClose,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(Button, {\n    onClick: openModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, \"Dodaj plik\"), React.createElement(Separator, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"gallery\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, items.map(function (item) {\n    return React.createElement(\"div\", {\n      key: item.id,\n      className: \"gallery__item\",\n      onClick: function onClick() {\n        return onSelect(item.url);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: item.url,\n      alt: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }));\n  }))), React.createElement(UploadModal, {\n    isOpen: isModal,\n    onClose: closeModal,\n    onDone: function onDone() {\n      fetchList();\n      closeModal();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }));\n});","map":{"version":3,"sources":["/home/kacper/Pulpit/tk-new-3/tk-pro-master/src/views/partials/UploadGridModal.js"],"names":["React","useState","useEffect","useApi","AlertContext","Modal","Loading","Separator","Button","UploadModal","ALERT_VARIANTS","API_URL","isOpen","onClose","onSelect","createAlert","api","isLoading","setIsLoading","isModal","setIsModal","items","setItems","openModal","closeModal","fetchList","get","data","images","map","item","id","url","pic","name","pic_text","String","fromCodePoint","danger"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport useApi from '../../hooks/useApi';\nimport AlertContext from '../../contexts/Alert';\nimport Modal from '../../components/Modal';\nimport Loading from '../../components/Loading';\nimport Separator from '../../components/Separator';\nimport Button from '../../components/Button';\nimport UploadModal from './UploadModal';\nimport { ALERT_VARIANTS, API_URL } from '../../config/constants';\n\nexport default ({ isOpen, onClose, onSelect }) => {\n  const { createAlert } = AlertContext();\n\n  const api = useApi();\n  const [isLoading, setIsLoading] = useState(true);\n  const [isModal, setIsModal] = useState(false);\n  const [items, setItems] = useState([]);\n\n  const openModal = () => setIsModal(true);\n  const closeModal = () => setIsModal(false);\n\n  const fetchList = async () => {\n    setIsLoading(true);\n\n    try {\n      const { data } = await api.get('/api/images/');\n\n      setItems(\n        data.images.map(item => ({\n          id: item.id,\n          url: API_URL + item.pic,\n          name: item.pic_text\n        }))\n      );\n    } catch (ex) {\n      createAlert(\n        `Błąd podczas ładowania plików ${String.fromCodePoint(0x26a0)}`,\n        ALERT_VARIANTS.danger\n      );\n    }\n\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    fetchList();\n  }, []);\n\n  return (\n    <Loading isActive={isLoading}>\n      <Modal isOpen={isOpen} onClose={onClose}>\n        <Button onClick={openModal}>Dodaj plik</Button>\n\n        <Separator />\n\n        <div className=\"gallery\">\n          {items.map(item => (\n            <div key={item.id} className=\"gallery__item\" onClick={() => onSelect(item.url)}>\n              <img src={item.url} alt={item.id} />\n            </div>\n          ))}\n        </div>\n      </Modal>\n\n      <UploadModal\n        isOpen={isModal}\n        onClose={closeModal}\n        onDone={() => {\n          fetchList();\n          closeModal();\n        }}\n      />\n    </Loading>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/kacper/Pulpit/prg/TK/tk-pro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Account.js\";\nimport React, { useState, useEffect } from 'react';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport Field from '../components/Field';\nimport Loading from '../components/Loading';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\nexport default (function () {\n  useTitle('Moje konto');\n  var api = useApi();\n\n  var _AlertContext = AlertContext(),\n      createAlert = _AlertContext.createAlert;\n\n  var _useForm = useForm(),\n      field = _useForm.field,\n      fields = _useForm.fields,\n      setFields = _useForm.setFields;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var getUserFromApi =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return api.get('/api/user/');\n\n            case 3:\n              response = _context.sent;\n              _context.next = 10;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              createAlert('Błąd pobierania danych użytkownika z serwisu', ALERT_VARIANTS.danger);\n              return _context.abrupt(\"return\");\n\n            case 10:\n              if (response.status === 200) {\n                res = response.data;\n                setIsLoading(false);\n                setFields({\n                  username: res.user[0].username,\n                  email: res.user[0].email\n                });\n              }\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 6]]);\n    }));\n\n    return function getUserFromApi() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              setIsLoading(true);\n              _context2.prev = 2;\n              _context2.next = 5;\n              return api.put('/api/change_user_values/', fields);\n\n            case 5:\n              response = _context2.sent;\n              _context2.next = 13;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](2);\n              createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.danger);\n              setIsLoading(false);\n              return _context2.abrupt(\"return\");\n\n            case 13:\n              if (!(response.status === 202)) {\n                _context2.next = 18;\n                break;\n              }\n\n              createAlert('Zmiana danych zakończona pomyślnie', ALERT_VARIANTS.success);\n              getUserFromApi();\n              _context2.next = 21;\n              break;\n\n            case 18:\n              createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.danger);\n              setIsLoading(false);\n              return _context2.abrupt(\"return\");\n\n            case 21:\n              setIsLoading(false);\n\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 8]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getUserFromApi();\n  }, []);\n  return React.createElement(Loading, {\n    isActive: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(Field, Object.assign({\n    label: \"Nazwa u\\u017Cytkownika\"\n  }, field('username'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Adres email\"\n  }, field('email'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Has\\u0142o\",\n    type: \"password\"\n  }, field('password'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  })), React.createElement(Field, Object.assign({\n    label: \"Powt\\xF3rz has\\u0142o\",\n    type: \"password\"\n  }, field('repassword'), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  })), React.createElement(Button, {\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"Zapisz zmiany\")));\n});","map":{"version":3,"sources":["/home/kacper/Pulpit/prg/TK/tk-pro/src/views/Account.js"],"names":["React","useState","useEffect","AlertContext","useTitle","useForm","Field","Loading","Button","ALERT_VARIANTS","useApi","api","createAlert","field","fields","setFields","isLoading","setIsLoading","getUserFromApi","get","response","danger","status","res","data","username","user","email","handleSubmit","e","preventDefault","put","success"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport AlertContext from '../contexts/Alert';\nimport useTitle from '../hooks/useTitle';\nimport useForm from '../hooks/useForm';\nimport Field from '../components/Field';\nimport Loading from '../components/Loading';\nimport Button from '../components/Button';\nimport { ALERT_VARIANTS } from '../config/constants';\nimport useApi from '../hooks/useApi';\n\nexport default () => {\n  useTitle('Moje konto');\n\n  const api = useApi();\n\n  const { createAlert } = AlertContext();\n  const { field, fields, setFields } = useForm();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const getUserFromApi = async () => {\n    let response;\n\n    try {\n      response = await api.get('/api/user/');\n    } catch (error) {\n      createAlert('Błąd pobierania danych użytkownika z serwisu', ALERT_VARIANTS.danger);\n      return;\n    }\n\n    if (response.status === 200) {\n      const res = response.data;\n\n      setIsLoading(false);\n\n      setFields({\n        username: res.user[0].username,\n        email: res.user[0].email\n      });\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    setIsLoading(true);\n\n    let response;\n\n    try {\n      response = await api.put('/api/change_user_values/', fields);\n    } catch (error) {\n      createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.danger);\n\n      setIsLoading(false);\n      return;\n    }\n\n    if (response.status === 202) {\n      createAlert('Zmiana danych zakończona pomyślnie', ALERT_VARIANTS.success);\n      getUserFromApi();\n    } else {\n      createAlert('Ups, coś poszło nie tak...', ALERT_VARIANTS.danger);\n\n      setIsLoading(false);\n      return;\n    }\n\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    getUserFromApi();\n  }, []);\n\n  return (\n    <Loading isActive={isLoading}>\n      <form onSubmit={handleSubmit}>\n        <Field label=\"Nazwa użytkownika\" {...field('username')} />\n        <Field label=\"Adres email\" {...field('email')} />\n        <Field label=\"Hasło\" type=\"password\" {...field('password')} />\n        <Field label=\"Powtórz hasło\" type=\"password\" {...field('repassword')} />\n\n        <Button type=\"submit\">Zapisz zmiany</Button>\n      </form>\n    </Loading>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}